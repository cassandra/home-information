{% extends "attribute/modals/attribute_edit_v2_base.html" %}
{% load icons %}

{% block modal_title %}{{ entity.name }}: Edit{% endblock %}

{% block form_action %}{% url 'entity_edit_v2' entity_id=entity.id %}{% endblock %}

{% block file_upload_form %}
  {% with file_upload_url='entity_attribute_upload' entity_id=entity.id %}
    <form action="{% url 'entity_attribute_upload' entity_id=entity.id %}" 
          method="post" 
          enctype="multipart/form-data"
          class="form" 
          data-async="true"
          data-stay-in-modal="true"
          style="display: none;">
      {% csrf_token %}
      <input type="file" 
             id="attr-v2-file-input" 
             name="file_value" 
             onchange="Hi.submitForm(this);">
    </form>
  {% endwith %}
{% endblock %}

{% block basic_info %}
<div class="attr-v2-basic-info">
  <div class="row">
    <div class="col-md-8">
      <div class="form-group mb-0">
        <small class="text-muted">Name</small>
        <input type="text" 
               id="{{ entity_form.name.id_for_label }}"
               name="{{ entity_form.name.html_name }}"
               value="{{ entity_form.name.value|default:entity.name }}"
               class="form-control form-control-sm"
               {% if entity_form.name.field.required %}required{% endif %}>
        {% if entity_form.name.errors %}
          <div class="invalid-feedback d-block">
            {{ entity_form.name.errors }}
          </div>
        {% endif %}
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group mb-0">
        <small class="text-muted">Type</small>
        <select id="{{ entity_form.entity_type_str.id_for_label }}"
                name="{{ entity_form.entity_type_str.html_name }}"
                class="form-control form-control-sm">
          {% for value, label in entity_form.entity_type_str.field.choices %}
            <option value="{{ value }}" 
                    {% if value == entity_form.entity_type_str.value|default:entity.entity_type_str %}selected{% endif %}>
              {{ label }}
            </option>
          {% endfor %}
        </select>
        {% if entity_form.entity_type_str.errors %}
          <div class="invalid-feedback d-block">
            {{ entity_form.entity_type_str.errors }}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block additional_actions %}
<a href="{% url 'entity_status' entity_id=entity.id %}" 
   class="btn btn-sm btn-outline-secondary"
   data-async="modal">
  Status
</a>
{% endblock %}