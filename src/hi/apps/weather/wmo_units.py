class WmoUnits:
    """
    WMO = World Meteorological Organisation
    """

    # This is not the exhaustive list. See: https://codes.wmo.int/common/unit
    #
    UNIT_DEFINITIONS = [
        {
            "wmoAbbrev" : "'",
            "wmoAbbrev2" : "'",
            "label" : "minute (angle)",
        },
        {
            "wmoAbbrev" : "''",
            "wmoAbbrev2" : "''",
            "label" : "second (angle)",
        },
        {
            "wmoAbbrev" : "1",
            "wmoAbbrev2" : "1",
            "label" : "Dimensionless",
        },
        {
            "wmoAbbrev" : "A",
            "wmoAbbrev2" : "A",
            "label" : "ampere",
        },
        {
            "wmoAbbrev" : "AU",
            "wmoAbbrev2" : "AU",
            "label" : "astronomic unit",
        },
        {
            "wmoAbbrev" : "Bq",
            "wmoAbbrev2" : "Bq",
            "label" : "becquerel",
        },
        {
            "wmoAbbrev" : "C",
            "wmoAbbrev2" : "C",
            "label" : "coulomb",
        },
        {
            "wmoAbbrev" : "˚C",
            "wmoAbbrev2" : "Cel",
            "label" : "degree Celsius",
        },
        {
            "wmoAbbrev" : "H",
            "wmoAbbrev2" : "H",
            "label" : "henry",
        },
        {
            "wmoAbbrev" : "Hz",
            "wmoAbbrev2" : "Hz",
            "label" : "hertz",
        },
        {
            "wmoAbbrev" : "J",
            "wmoAbbrev2" : "J",
            "label" : "joule",
        },
        {
            "wmoAbbrev" : "J kg^-1",
            "wmoAbbrev2" : "J/kg",
            "label" : "joules per kilogram",
        },
        {
            "wmoAbbrev" : "K",
            "wmoAbbrev2" : "K",
            "label" : "kelvin",
        },
        {
            "wmoAbbrev" : "N",
            "wmoAbbrev2" : "N",
            "label" : "newton",
        },
        {
            "wmoAbbrev" : "Ω",
            "wmoAbbrev2" : "Ohm",
            "label" : "ohm",
        },
        {
            "wmoAbbrev" : "Pa",
            "wmoAbbrev2" : "Pa",
            "label" : "pascal",
        },
        {
            "wmoAbbrev" : "Pa s^-1",
            "wmoAbbrev2" : "Pa/s",
            "label" : "pascals per second",
        },
        {
            "wmoAbbrev" : "T",
            "wmoAbbrev2" : "T",
            "label" : "tesla",
        },
        {
            "wmoAbbrev" : "V",
            "wmoAbbrev2" : "V",
            "label" : "volt",
        },
        {
            "wmoAbbrev" : "W",
            "wmoAbbrev2" : "W",
            "label" : "watt",
        },
        {
            "wmoAbbrev" : "Wb",
            "wmoAbbrev2" : "Wb",
            "label" : "weber",
        },
        {
            "wmoAbbrev" : "a",
            "wmoAbbrev2" : "a",
            "label" : "year",
        },
        {
            "wmoAbbrev" : "cd",
            "wmoAbbrev2" : "cd",
            "label" : "candela",
        },
        {
            "wmoAbbrev" : "cm",
            "wmoAbbrev2" : "cm",
            "label" : "centimetre",
        },
        {
            "wmoAbbrev" : "cm h^-1",
            "wmoAbbrev2" : "cm/h",
            "label" : "centimetres per hour",
        },
        {
            "wmoAbbrev" : "cm s^-1",
            "wmoAbbrev2" : "cm/s",
            "label" : "centimetres per second",
        },
        {
            "wmoAbbrev" : "d",
            "wmoAbbrev2" : "d",
            "label" : "day",
        },
        {
            "wmoAbbrev" : "dB",
            "wmoAbbrev2" : "dB",
            "label" : "decibel",
        },
        {
            "wmoAbbrev" : "dB degree^-1",
            "wmoAbbrev2" : "dB/deg",
            "label" : "decibels per degree",
        },
        {
            "wmoAbbrev" : "dB m^-1",
            "wmoAbbrev2" : "dB/m",
            "label" : "decibels per metre",
        },
        {
            "wmoAbbrev" : "daPa",
            "wmoAbbrev2" : "daPa",
            "label" : "dekapascal",
        },
        {
            "wmoAbbrev" : "degrees^2",
            "wmoAbbrev2" : "deg^2",
            "label" : "square degrees",
        },
        {
            "wmoAbbrev" : "degree/s",
            "wmoAbbrev2" : "deg/s",
            "label" : "degrees per second",
        },
        {
            "wmoAbbrev" : "˚",
            "wmoAbbrev2" : "deg",
            "label" : "degree (angle)",
        },
        {
            "wmoAbbrev" : "dm",
            "wmoAbbrev2" : "dm",
            "label" : "decimetre",
        },
        {
            "wmoAbbrev" : "eV",
            "wmoAbbrev2" : "eV",
            "label" : "electron volt",
        },
        {
            "wmoAbbrev" : "ft",
            "wmoAbbrev2" : "ft",
            "label" : "foot",
        },
        {
            "wmoAbbrev" : "g",
            "wmoAbbrev2" : "g",
            "label" : "acceleration due to gravity",
        },
        {
            "wmoAbbrev" : "g kg^-1",
            "wmoAbbrev2" : "g/kg",
            "label" : "grams per kilogram",
        },
        {
            "wmoAbbrev" : "g kg^-1 s^-1",
            "wmoAbbrev2" : "g kg-1 s-1",
            "label" : "grams per kilogram per second",
        },
        {
            "wmoAbbrev" : "h",
            "wmoAbbrev2" : "h",
            "label" : "hour",
        },
        {
            "wmoAbbrev" : "hPa",
            "wmoAbbrev2" : "hPa",
            "label" : "hectopascal",
        },
        {
            "wmoAbbrev" : "ha",
            "wmoAbbrev2" : "ha",
            "label" : "hectare",
        },
        {
            "wmoAbbrev" : "kPa",
            "wmoAbbrev2" : "kPa",
            "label" : "kilopascal",
        },
        {
            "wmoAbbrev" : "kg",
            "wmoAbbrev2" : "kg",
            "label" : "kilogram",
        },
        {
            "wmoAbbrev" : "kg^-2 s^-1",
            "wmoAbbrev2" : "kg-2 s-1",
            "label" : "per square kilogram per second",
        },
        {
            "wmoAbbrev" : "kg kg^-1",
            "wmoAbbrev2" : "kg/kg",
            "label" : "kilograms per kilogram",
        },
        {
            "wmoAbbrev" : "kg kg^-1 s^-1",
            "wmoAbbrev2" : "kg kg-1 s-1",
            "label" : "kilograms per kilogram per second",
        },
        {
            "wmoAbbrev" : "km m^-1",
            "wmoAbbrev2" : "kg/m",
            "label" : "kilograms per metre",
        },
        {
            "wmoAbbrev" : "kg m^-2",
            "wmoAbbrev2" : "kg m-2",
            "label" : "kilograms per square metre",
        },
        {
            "wmoAbbrev" : "kg m^-2 s^-1",
            "wmoAbbrev2" : "kg m-2 s-1",
            "label" : "kilograms per square metre per second",
        },
        {
            "wmoAbbrev" : "kg m^-3",
            "wmoAbbrev2" : "kg m-3",
            "label" : "kilograms per cubic metre",
        },
        {
            "wmoAbbrev" : "km",
            "wmoAbbrev2" : "km",
            "label" : "kilometre",
        },
        {
            "wmoAbbrev" : "km/d",
            "wmoAbbrev2" : "km/d",
            "label" : "kilometres per day",
        },
        {
            "wmoAbbrev" : "km h^-1",
            "wmoAbbrev2" : "km/h",
            "label" : "kilometres per hour",
        },
        {
            "wmoAbbrev" : "kt",
            "wmoAbbrev2" : "kt",
            "label" : "knot",
        },
        {
            "wmoAbbrev" : "kt/1000 m",
            "wmoAbbrev2" : "kt/km",
            "label" : "knots per 1000 metres",
        },
        {
            "wmoAbbrev" : "l",
            "wmoAbbrev2" : "l",
            "label" : "litre",
        },
        {
            "wmoAbbrev" : "lm",
            "wmoAbbrev2" : "lm",
            "label" : "lumen",
        },
        {
            "wmoAbbrev" : "lx",
            "wmoAbbrev2" : "lx",
            "label" : "lux",
        },
        {
            "wmoAbbrev" : "m",
            "wmoAbbrev2" : "m",
            "label" : "metre",
        },
        {
            "wmoAbbrev" : "m^2",
            "wmoAbbrev2" : "m2",
            "label" : "square metres",
        },
        {
            "wmoAbbrev" : "m^2 Hz^-1",
            "wmoAbbrev2" : "m2/Hz",
            "label" : "square metres per hertz",
        },
        {
            "wmoAbbrev" : "m^2 rad^-1 s",
            "wmoAbbrev2" : "m2 rad-1 s",
            "label" : "square metres per radian squared",
        },
        {
            "wmoAbbrev" : "m^2 s",
            "wmoAbbrev2" : "m2 s",
            "label" : "square metres second",
        },
        {
            "wmoAbbrev" : "m^2 s^-1",
            "wmoAbbrev2" : "m2/s",
            "label" : "square metres per second",
        },
        {
            "wmoAbbrev" : "m^2 s^-2",
            "wmoAbbrev2" : "m2 s-2",
            "label" : "square metres per second squared",
        },
        {
            "wmoAbbrev" : "m^3",
            "wmoAbbrev2" : "m3",
            "label" : "cubic metres",
        },
        {
            "wmoAbbrev" : "m^3 m^-3",
            "wmoAbbrev2" : "m3 m-3",
            "label" : "cubic metres per cubic metre",
        },
        {
            "wmoAbbrev" : "m^3 s^-1",
            "wmoAbbrev2" : "m3/s",
            "label" : "cubic metres per second",
        },
        {
            "wmoAbbrev" : "m^4",
            "wmoAbbrev2" : "m4",
            "label" : "metres to the fourth power",
        },
        {
            "wmoAbbrev" : "mSv",
            "wmoAbbrev2" : "mSv",
            "label" : "millisievert",
        },
        {
            "wmoAbbrev" : "m",
            "wmoAbbrev2" : "m",
            "label" : "milli",
        },
        {
            "wmoAbbrev" : "m s^-1",
            "wmoAbbrev2" : "m/s",
            "label" : "metres per second",
        },
        {
            "wmoAbbrev" : "m s^-1/1000 m",
            "wmoAbbrev2" : "m s-1/km",
            "label" : "metres per second per 1000 metres",
        },
        {
            "wmoAbbrev" : "m s^-1/m",
            "wmoAbbrev2" : "m s-1/m",
            "label" : "metres per second per metre",
        },
        {
            "wmoAbbrev" : "m s^-2",
            "wmoAbbrev2" : "m s-2",
            "label" : "metres per second squared",
        },
        {
            "wmoAbbrev" : "min",
            "wmoAbbrev2" : "min",
            "label" : "minute (time)",
        },
        {
            "wmoAbbrev" : "mm",
            "wmoAbbrev2" : "mm",
            "label" : "millimetre",
        },
        {
            "wmoAbbrev" : "mm^6 m^-3",
            "wmoAbbrev2" : "mm6 m-3",
            "label" : "millimetres per the sixth power per cubic metre",
        },
        {
            "wmoAbbrev" : "mm h^-1",
            "wmoAbbrev2" : "mm/h",
            "label" : "millimetres per hour",
        },
        {
            "wmoAbbrev" : "mm s^-1",
            "wmoAbbrev2" : "mm/s",
            "label" : "millimetres per seconds",
        },
        {
            "wmoAbbrev" : "mol",
            "wmoAbbrev2" : "mol",
            "label" : "mole",
        },
        {
            "wmoAbbrev" : " mol mol^-1",
            "wmoAbbrev2" : "mol/mol",
            "label" : "moles per mole",
        },
        {
            "wmoAbbrev" : "mon",
            "wmoAbbrev2" : "mon",
            "label" : "month",
        },
        {
            "wmoAbbrev" : "nm",
            "label" : "nautical mile",
        },
        {
            "wmoAbbrev" : "nbar",
            "wmoAbbrev2" : "nbar",
            "label" : "nanobar = hPa 10^-6",
        },
        {
            "wmoAbbrev" : "okta",
            "wmoAbbrev2" : "okta",
            "label" : "eighths of cloud",
        },
        {
            "wmoAbbrev" : "pH unit",
            "wmoAbbrev2" : "pH unit",
            "label" : "pH unit",
        },
        {
            "wmoAbbrev" : "pc",
            "wmoAbbrev2" : "pc",
            "label" : "parsec",
        },
        {
            "wmoAbbrev" : "%",
            "wmoAbbrev2" : "%",
            "label" : "per cent",
        },
        {
            "wmoAbbrev" : "rad",
            "wmoAbbrev2" : "rad",
            "label" : "radian",
        },
        {
            "wmoAbbrev" : "rad m^-1",
            "wmoAbbrev2" : "rad/m",
            "label" : "radians per metre",
        },
        {
            "wmoAbbrev" : "s",
            "wmoAbbrev2" : "s",
            "label" : "second",
        },
        {
            "wmoAbbrev" : "s m^-1",
            "wmoAbbrev2" : "s/m",
            "label" : "seconds per metre",
        },
        {
            "wmoAbbrev" : "sr",
            "wmoAbbrev2" : "sr",
            "label" : "steradian",
        },
        {
            "wmoAbbrev" : "t",
            "wmoAbbrev2" : "t",
            "label" : "tonne",
        },
        {
            "wmoAbbrev" : "u",
            "wmoAbbrev2" : "u",
            "label" : "atomic mass unit",
        },
        {
            "wmoAbbrev" : "µ",
            "wmoAbbrev2" : "u",
            "label" : "micro",
        },
        {
            "wmoAbbrev" : "week",
            "label" : "week",
        },
    ]

    # The Pint unit package does not recognize a lot of the "wmoAbbrev2"
    # variations, so we will map them to the canonical abbreviation which
    # are easier for Pint to handle.
    #
    CANONICAL_MAP = { x['wmoAbbrev2']: x['wmoAbbrev']
                      for x in UNIT_DEFINITIONS
                      if 'wmoAbbrev2' in x }

    # The Pint units package also has some limitations on its
    # syntax. Special characters, spaces and such cause it issues. We deal
    # with these here.
    #
    UNIT_ALIASES = {
        '"': 'arcsecond',
        "'": 'arcminute',
        "''": 'arcsecond',
        '˚': 'degree',
        'Ω': 'ohm',
        'kt/1000 m': "kt/km",
        'm s^-1/1000 m': 'm s^-1/km',
    }
    
    @classmethod
    def normalize_unit( cls, unit_str : str ) -> str:
        """ Convert a WMO units string into a form acceptable by the Pint units package """

        if not unit_str:
            return unit_str
        if unit_str.startswith( 'wmoUnit:' ):
            unit_str = unit_str[8:]
        elif unit_str.startswith( 'wmo:' ):
            unit_str = unit_str[5:]
        elif unit_str.startswith( 'unit:' ):
            unit_str = unit_str[5:]
        else:
            unit_str = unit_str

        if unit_str in cls.CANONICAL_MAP:
            unit_str = cls.CANONICAL_MAP.get( unit_str )
            
        if unit_str in cls.UNIT_ALIASES:
            unit_str = cls.UNIT_ALIASES.get( unit_str )
            
        return unit_str.strip()
